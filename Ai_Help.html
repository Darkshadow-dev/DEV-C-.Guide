<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ollama Chat</title>
<style>
body { font-family: sans-serif; background:#f3f3f3; padding:20px; }
#chat { background:white; padding:10px; border-radius:10px; height:60vh; overflow-y:auto; }
.msg { margin:8px 0; }
.user { text-align:right; color:#0074D9; }
.bot { text-align:left; color:#111; }
#input-area { display:flex; margin-top:10px; gap:10px; }
#msg { flex:1; padding:8px; font-size:16px; }
button { padding:8px 16px; font-size:16px; }
</style>
</head>
<body>
<h2>💬 Chat with Llama 3.2</h2>
<div id="chat"></div>
<div id="input-area">
  <input id="msg" type="text" placeholder="Type your message..." />
  <button id="send">Send</button>
</div>

<script>
const chat = document.getElementById('chat');
const input = document.getElementById('msg');
const send = document.getElementById('send');

function addMessage(text, who) {
  const div = document.createElement('div');
  div.className = 'msg ' + who;
  div.textContent = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

async function sendMessage() {
  const text = input.value.trim();
  if (!text) return;
  addMessage(text, 'user');
  input.value = '';
  send.disabled = true;
  try {
    const res = await fetch('/chat', {
      method: 'POST',
      headers: {'Content-Type':'application/json'},
      body: JSON.stringify({ message: text })
    });
    const data = await res.json();
    addMessage(data.reply || data.error || 'Error', 'bot');
  } catch (err) {
    addMessage('⚠️ ' + err.message, 'bot');
  }
  send.disabled = false;
}

send.onclick = sendMessage;
input.addEventListener('keydown', e => {
  if (e.key === 'Enter') sendMessage();
});
</script>
</body>
</html>
